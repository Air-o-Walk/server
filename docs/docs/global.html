<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Global</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Global</h1>

    




<section>

<header>
    
        <h2></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

        


<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="addDailyStats"><span class="type-signature">(async) </span>addDailyStats<span class="signature">(userId, activeHours, distance, points)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Registra una nueva entrada en la tabla `daily_stats` de un usuario.

El proceso realiza las siguientes acciones:
- Inserta una nueva fila en la tabla `daily_stats` con las horas activas,
  distancia recorrida y puntos obtenidos.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario al que se le añaden las estadísticas.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>activeHours</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Horas activas del usuario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>distance</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Distancia recorrida por el usuario (en km o la unidad usada en la tabla).</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>points</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Puntos obtenidos por el usuario.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1059">line 1059</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la inserción.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la inserción fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="addPoints"><span class="type-signature">(async) </span>addPoints<span class="signature">(userId, pointsToAdd)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|number|string}</span></h4>
    

    



<div class="description">
    Suma puntos al total de un usuario.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista en la tabla `users`.
- Calcula el nuevo total de puntos sumando `pointsToAdd`.
- Actualiza la tabla `users` con el nuevo total de puntos.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario al que se le añadirán puntos.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>pointsToAdd</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Cantidad de puntos a añadir.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1327">line 1327</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la actualización de puntos.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.totalPoints] Total de puntos del usuario tras la suma, disponible si `success` es true.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="apply"><span class="type-signature">(async) </span>apply<span class="signature">(params)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|string}</span></h4>
    

    



<div class="description">
    Guarda una nueva solicitud en la tabla `applications`.

El proceso realiza las siguientes acciones:
- Valida que todos los campos obligatorios estén presentes.
- Verifica que el email no esté registrado en la tabla `users`.
- Inserta la solicitud en la tabla `applications`.
- Si la inserción es exitosa, llama a `registerUser` para crear el usuario automáticamente.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Objeto con los datos de la solicitud.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>firstName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre del solicitante.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lastName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Apellido del solicitante.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>email</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Email del solicitante.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>dni</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">DNI del solicitante.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>phone</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Teléfono del solicitante.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>townHallId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del ayuntamiento asociado.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1157">line 1157</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la inserción de la solicitud.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="calculateDistance"><span class="type-signature"></span>calculateDistance<span class="signature">(lat1, lon1, lat2, lon2)</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    Calcula la distancia en kilómetros entre dos coordenadas geográficas
usando la fórmula del haversine.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>lat1</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Latitud del primer punto en grados.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lon1</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Longitud del primer punto en grados.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lat2</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Latitud del segundo punto en grados.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lon2</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Longitud del segundo punto en grados.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line2264">line 2264</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Distancia entre los dos puntos en kilómetros.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="calidad_del_aire_cara_y_mensaje"><span class="type-signature">(async) </span>calidad_del_aire_cara_y_mensaje<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Calcula el estado general de la calidad del aire y genera un mensaje resumen
usando las mediciones del nodo vinculado en las últimas 8 horas.

El proceso realiza las siguientes acciones:
- Obtiene el nodo vinculado al usuario mediante `getLinkedNodeOfUser`.
- Consulta las mediciones de los últimos 8 horas (O3, NO2, CO).
- Clasifica la calidad del aire usando `clasificarCalidadDelAire`.
- Devuelve un estado general (`status`) y un mensaje resumen (`summaryText`).
- Si no hay mediciones recientes, asume que la calidad del aire es buena.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario para el que se calcula la calidad del aire.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line576">line 576</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante el cálculo de la calidad del aire.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado del cálculo de la calidad del aire.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.status] Estado general de la calidad del aire ('buena', 'regular', 'mala', etc.).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.summaryText] Mensaje resumen explicativo de la calidad del aire.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla o no hay nodo vinculado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="clasificarCalidadDelAire"><span class="type-signature"></span>clasificarCalidadDelAire<span class="signature">(measurements)</span><span class="type-signature"> &rarr; {Object|string|string}</span></h4>
    

    



<div class="description">
    Clasifica la calidad del aire según los valores de O₃, NO₂ y CO.

El proceso realiza las siguientes acciones:
- Recorre las mediciones proporcionadas.
- Calcula un índice normalizado por medición basado en O₃, NO₂ y CO.
- Determina el estado general de la calidad del aire y genera un mensaje resumen.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>measurements</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">Array de objetos de medición.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>o3_value</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de O₃ de la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>no2_value</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de NO₂ de la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>co_value</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de CO de la medición.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line949">line 949</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la clasificación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.status Estado general de la calidad del aire ('buena', 'regular', 'picos', 'mala').
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.summaryText Mensaje descriptivo del estado de la calidad del aire.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="deleteApplication"><span class="type-signature">(async) </span>deleteApplication<span class="signature">(applicationId)</span><span class="type-signature"> &rarr; {Promise.&lt;boolean>}</span></h4>
    

    



<div class="description">
    Elimina una solicitud de la tabla `applications` por su ID.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>applicationId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID de la solicitud a eliminar.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1225">line 1225</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la eliminación.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    `true` si la eliminación fue exitosa, `false` en caso contrario.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;boolean></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="enviarCorreoRecuperacion"><span class="type-signature">(async) </span>enviarCorreoRecuperacion<span class="signature">(to, username, tempPassword)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    Envía un correo electrónico de recuperación de contraseña a un usuario.

Este servicio utiliza Nodemailer para enviar un email con la contraseña temporal generada.
Se debe configurar correctamente el usuario y contraseña SMTP para que funcione.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>to</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Correo electrónico del destinatario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre de usuario del destinatario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tempPassword</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Contraseña temporal a incluir en el correo.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Christopher Yoris</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line2086">line 2086</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Promesa que se resuelve cuando el correo es enviado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="generateCouponCode"><span class="type-signature"></span>generateCouponCode<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Genera un código de cupón único en formato XXX-YYYY-ZZZZ.

El código está compuesto por tres bloques separados por guiones:
- Bloque 1: 4 caracteres alfabéticos y/o numéricos
- Bloque 2: 4 caracteres alfabéticos y/o numéricos
- Bloque 3: 4 caracteres alfabéticos y/o numéricos

Ejemplo de salida: "AB12-3F4G-ZX9Q"
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1938">line 1938</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Código de cupón único generado aleatoriamente.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getAirQualitySummary"><span class="type-signature">(async) </span>getAirQualitySummary<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Obtiene un resumen completo de la calidad del aire para un usuario.

Combina múltiples métricas:
- Estado general de la calidad del aire y mensaje resumen.
- Tiempo activo acumulado en las últimas 8 horas.
- Distancia recorrida en las últimas 8 horas.
- Puntos obtenidos en las últimas 8 horas.
- Datos necesarios para dibujar la gráfica de calidad del aire.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario para el que se genera el resumen.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line880">line 880</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la generación del resumen.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado del resumen completo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.status] Estado general de la calidad del aire ('buena', 'regular', 'mala', etc.).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.summaryText] Mensaje resumen de la calidad del aire.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.timeHours] Tiempo activo acumulado en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.distanceKm] Distancia total recorrida en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.points] Puntos obtenidos en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.graph] Datos para la gráfica de calidad del aire (timestamps, valores de contaminantes e índice normalizado).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si alguna de las consultas falla.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getAyuntamientos"><span class="type-signature">(async) </span>getAyuntamientos<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Array.&lt;{id: string, name: string}>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Devuelve la lista de ayuntamientos (id y nombre) ordenados alfabéticamente.

El proceso realiza las siguientes acciones:
- Consulta la tabla `town_halls` para obtener todos los registros.
- Devuelve un array de objetos con `id` y `name`.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1102">line 1102</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.data] Array de objetos con los ayuntamientos.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.data Lista de ayuntamientos con id y nombre.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;{id: string, name: string}></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getLinkedNodeOfUser"><span class="type-signature">(async) </span>getLinkedNodeOfUser<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Devuelve el nodo actualmente vinculado a un usuario.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista.
- Busca un nodo activo vinculado al usuario.
- Devuelve el nodo si existe o un mensaje de error si no hay nodo vinculado.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario del que se desea obtener el nodo vinculado.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line445">line 445</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.node] Objeto con la información del nodo vinculado si existe.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo de error si no hay nodo vinculado o si el usuario no existe.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getMeasurements"><span class="type-signature">(async) </span>getMeasurements<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|Array.&lt;Object>|number|number|Date|string|number|number|number|number|number|string}</span></h4>
    

    



<div class="description">
    Obtiene todas las mediciones registradas en la base de datos.

Devuelve todas las filas de la tabla `measurements` con todos sus campos.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1971">line 1971</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success - Indica si la consulta fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.measurements] - Lista de mediciones.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].id - ID de la medición.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].node_id - ID del nodo al que pertenece la medición.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].timestamp - Fecha y hora de la medición.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Date</span>
|

<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].co_value - Valor de CO medido.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].o3_value - Valor de O₃ medido.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].no2_value - Valor de NO₂ medido.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].latitude - Latitud donde se realizó la medición.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.measurements[].longitude - Longitud donde se realizó la medición.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] - Mensaje de error en caso de fallo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getNearestMeasurement"><span class="type-signature">(async) </span>getNearestMeasurement<span class="signature">(latTarget, lonTarget)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|Object|number|number|string}</span></h4>
    

    



<div class="description">
    Obtiene la medición más cercana a unas coordenadas específicas.

Consulta todas las mediciones en la base de datos, calcula la distancia
a cada una desde la ubicación objetivo y devuelve la medición más cercana.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>latTarget</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Latitud de referencia.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lonTarget</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Longitud de referencia.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line2214">line 2214</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success - Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.data] - Valores de la medición más cercana.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.data.o3_value - Valor de O₃ de la medición más cercana.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.data.no2_value - Valor de NO₂ de la medición más cercana.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] - Mensaje de error en caso de fallo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getPoints"><span class="type-signature">(async) </span>getPoints<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|number|string}</span></h4>
    

    



<div class="description">
    Obtiene los puntos totales de un usuario.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista en la tabla `users`.
- Devuelve los puntos acumulados del usuario.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1279">line 1279</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.points] Puntos del usuario, disponible si `success` es true.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo en caso de error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getPrizes"><span class="type-signature">(async) </span>getPrizes<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|Array.&lt;Object>|string}</span></h4>
    

    



<div class="description">
    Obtiene todas las recompensas activas disponibles.

Solo devuelve premios con `active > 0` y `quantity_available > 0`, ordenados por `points_required`.
</div>













    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del premio.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre del premio.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>description</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Descripción del premio.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>points_required</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Puntos necesarios para canjearlo.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>quantity_available</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Cantidad disponible actualmente.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>initial_quantity</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Cantidad inicial del premio.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>active</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Indicador de si el premio está activo.</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1693">line 1693</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la consulta fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.prizes] Lista de premios (solo si success=true). Cada premio contiene:
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error en caso de fallo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="getRedemptionHistory"><span class="type-signature">(async) </span>getRedemptionHistory<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|Array.&lt;Object>|number|string|Date|string|string|string|number|string|string}</span></h4>
    

    



<div class="description">
    Obtiene el historial de premios canjeados por un usuario.

Valida que el usuario exista y devuelve todos los canjes realizados junto con la información del premio.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1876">line 1876</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success - Indica si la consulta fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.redemptions] - Lista de canjes realizados por el usuario.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].id - ID del registro de canje.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].coupon_code - Código de cupón generado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].redemption_date - Fecha del canje.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Date</span>
|

<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].prize_name - Nombre del premio canjeado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].description - Descripción del premio.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].points_required - Puntos requeridos para canjear el premio.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.redemptions[].image_url - URL de la imagen del premio.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] - Mensaje de error en caso de fallo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="get_distancia"><span class="type-signature">(async) </span>get_distancia<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Obtiene la distancia total recorrida por un usuario en las últimas 8 horas.

El proceso realiza las siguientes acciones:
- Consulta la tabla `daily_stats` para sumar la distancia recorrida por el usuario
  en las últimas 8 horas.
- Devuelve la distancia total acumulada en kilómetros.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuya distancia se desea consultar.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line692">line 692</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.distanceKm] Distancia total recorrida en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="get_puntos"><span class="type-signature">(async) </span>get_puntos<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Obtiene la suma de puntos de un usuario en las últimas 8 horas.

El proceso realiza las siguientes acciones:
- Consulta la tabla `daily_stats` para sumar los puntos obtenidos por el usuario
  en las últimas 8 horas.
- Devuelve el total de puntos acumulados.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuyos puntos se desean consultar.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line737">line 737</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.points] Total de puntos obtenidos en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="get_tiempo"><span class="type-signature">(async) </span>get_tiempo<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Obtiene el tiempo activo acumulado por un usuario en las últimas 8 horas.

El proceso realiza las siguientes acciones:
- Consulta la tabla `daily_stats` para sumar las horas activas del usuario
  en las últimas 8 horas.
- Devuelve el total de horas acumuladas.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuyo tiempo activo se desea consultar.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line648">line 648</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la consulta.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.timeHours] Total de horas activas acumuladas en las últimas 8 horas.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="insertMeasurement"><span class="type-signature">(async) </span>insertMeasurement<span class="signature">(nodeId, co, o3, no2, latitude, longitude)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Inserta una medición de un nodo en la tabla `measurements`.

El proceso realiza las siguientes acciones:
- Verifica que el nodo exista en la base de datos.
- Inserta una nueva fila en la tabla `measurements` con los valores proporcionados.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>nodeId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del nodo que realiza la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>co</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de CO de la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>o3</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de O₃ de la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>no2</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Valor de NO₂ de la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>latitude</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Latitud donde se realizó la medición.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>longitude</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Longitud donde se realizó la medición.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1007">line 1007</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la inserción.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la inserción fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="linkNodeToUser"><span class="type-signature">(async) </span>linkNodeToUser<span class="signature">(userId, nodeName)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Vincula un nodo/sensor a un usuario, evitando duplicados y manejando reactivación.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista.
- Comprueba si ya existe un nodo con el mismo nombre.
- Inserta un nuevo nodo si no existe.
- Reactiva el nodo si estaba inactivo.
- Devuelve error si el nodo ya está activo con otro usuario o si ya está vinculado al mismo usuario.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario al que se quiere vincular el nodo.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>nodeName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre del nodo/sensor a vincular.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line271">line 271</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante el proceso de vinculación.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo de la operación o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.nodeId] ID del nodo vinculado o reactivado, si aplica.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="loginUser"><span class="type-signature">(async) </span>loginUser<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    2. loginUser(username, password)
Autentica un usuario y genera un token de sesión

username, password ---> loginUser() ---> {success, token, userId} || error "Usuario no encontrado" || error "Contraseña incorrecta"
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line149">line 149</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="loginUser"><span class="type-signature">(async) </span>loginUser<span class="signature">(username, password)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Autentica un usuario mediante nombre de usuario y contraseña.

El proceso realiza las siguientes acciones:
- Busca el usuario en la base de datos por su nombre de usuario.
- Verifica la contraseña cifrada mediante bcrypt.
- Genera un token JWT de sesión con una validez de 24 horas.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre de usuario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>password</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Contraseña en texto plano.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirres</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line198">line 198</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante el proceso de autenticación.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la autenticación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la autenticación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.token] Token JWT generado si la autenticación es correcta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.userId] Identificador del usuario autenticado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error en caso de fallo.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="recoverPassword"><span class="type-signature">(async) </span>recoverPassword<span class="signature">(email)</span><span class="type-signature"> &rarr; {Promise.&lt;{success: boolean, message: string}>|boolean|string}</span></h4>
    

    



<div class="description">
    Recupera la contraseña de un usuario de forma temporal.

Flujo:
1. Busca al usuario por email.
2. Genera una contraseña temporal fija (modo testing).
3. Hashea la contraseña temporal y actualiza la base de datos.
4. Intenta enviar un correo con la contraseña temporal.
5. Siempre devuelve success al frontend por motivos de seguridad,
   aunque el correo no exista.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>email</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Correo electrónico del usuario.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Christopher Yoris</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line2014">line 2014</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;{success: boolean, message: string}></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success - Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message - Mensaje informativo o de error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="redeemPrize"><span class="type-signature">(async) </span>redeemPrize<span class="signature">(userId, prizeId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|string|string|string|number|number|number|number}</span></h4>
    

    



<div class="description">
    Canjea puntos del usuario por un premio.

Valida que el usuario exista, que tenga suficientes puntos, que el premio esté activo y tenga stock.
Actualiza los puntos del usuario, reduce el stock del premio y genera un cupón único.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario que quiere canjear el premio.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>prizeId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del premio que se desea canjear.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Santiago Aguirre</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1740">line 1740</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si el canje fue exitoso.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje informativo del resultado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.couponCode] Código de cupón generado (solo si success=true).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.prizeName] Nombre del premio canjeado (solo si success=true).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.pointsSpent] Puntos utilizados para el canje (solo si success=true).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.remainingPoints] Puntos restantes del usuario (solo si success=true).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.pointsNeeded] Puntos necesarios (solo si success=false por puntos insuficientes).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.currentPoints] Puntos actuales del usuario (solo si success=false por puntos insuficientes).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="registerUser"><span class="type-signature">(async) </span>registerUser<span class="signature">(email)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Registra un nuevo usuario en el sistema a partir de una solicitud previa.

El proceso realiza las siguientes acciones:
- Obtiene la solicitud más reciente asociada al email proporcionado.
- Asigna el rol por defecto "walker".
- Genera y cifra la contraseña a partir del DNI.
- Crea automáticamente el nombre de usuario.
- Inserta el usuario en la base de datos.
- Envía un correo con las credenciales de acceso.
- Elimina la solicitud de aplicación asociada.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>email</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Email del solicitante registrado previamente en applications.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line25">line 25</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante el proceso de registro.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si el registro fue exitoso.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message Mensaje descriptivo del resultado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="sendMail"><span class="type-signature">(async) </span>sendMail<span class="signature">(params)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    Envía un correo de bienvenida a un usuario utilizando la función `bienvenida` de `config/correo.js`.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Objeto con los datos del correo.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>to</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Email del destinatario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>firstName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre del destinatario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre de usuario del destinatario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rawPassword</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Contraseña en texto plano del usuario.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1250">line 1250</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado al enviar el correo.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    No devuelve ningún valor; captura errores internamente y los registra en consola.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="unlinkNodeFromUser"><span class="type-signature">(async) </span>unlinkNodeFromUser<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Elimina la vinculación del nodo activo de un usuario.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista.
- Busca el nodo activo vinculado al usuario.
- Desvincula el nodo actualizando su estado a 'inactive' y eliminando la relación con el usuario.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuyo nodo se desea desvincular.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line511">line 511</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la desvinculación del nodo.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="updateUser"><span class="type-signature">(async) </span>updateUser<span class="signature">(userId, updateData)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|boolean|string}</span></h4>
    

    



<div class="description">
    Actualiza el perfil de un usuario.

Permite modificar el nombre de usuario, el email y/o la contraseña. 
La contraseña actual es requerida si se desea establecer una nueva.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario a actualizar.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>updateData</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Objeto con los campos a actualizar.
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Nuevo nombre de usuario.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>email</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Nuevo email.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>current_password</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Contraseña actual, necesaria si se cambia la contraseña.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>new_password</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Nueva contraseña a establecer.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1533">line 1533</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la operación.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la actualización fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message Mensaje descriptivo sobre la operación o el error ocurrido.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="updateUserActivity"><span class="type-signature">(async) </span>updateUserActivity<span class="signature">(userId, time, distance)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Actualiza las horas activas y la distancia total recorrida de un usuario.

El proceso realiza las siguientes acciones:
- Verifica que el usuario exista.
- Calcula los nuevos valores de horas activas y distancia total sumando los proporcionados.
- Actualiza los valores en la base de datos.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuya actividad se desea actualizar.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>time</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Tiempo activo a sumar (en horas o unidades definidas).</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>distance</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Distancia recorrida a sumar (en unidades definidas, p.ej. metros o km).</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>IDK</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line374">line 374</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la actualización de la actividad.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la actualización.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.message Mensaje descriptivo del resultado o error.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.active_hours] Nuevas horas activas del usuario, si la actualización fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.total_distance] Nueva distancia total del usuario, si la actualización fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
            

    

    
    <h4 class="name" id="valores_grafica"><span class="type-signature">(async) </span>valores_grafica<span class="signature">(userId)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>|Promise.&lt;Object>|Promise.&lt;Object>|Array.&lt;string>|Array.&lt;number>|Array.&lt;number>|Array.&lt;number>|Array.&lt;number>|Promise.&lt;Object>}</span></h4>
    

    



<div class="description">
    Obtiene los valores necesarios para dibujar la gráfica de calidad del aire
y calcula el índice normalizado (0–1) por instante.

El proceso realiza las siguientes acciones:
- Obtiene el nodo vinculado al usuario mediante `getLinkedNodeOfUser`.
- Consulta las mediciones de O3, NO2 y CO de las últimas 8 horas.
- Calcula el índice normalizado por cada instante.
- Devuelve un objeto con los arrays de timestamps, valores de contaminantes e índice normalizado.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>userId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del usuario cuyos datos de calidad del aire se desean consultar.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Meryame Ait Boumlik</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line782">line 782</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Si ocurre un error inesperado durante la obtención de datos para la gráfica.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>
<ul>
        <li>
<div class="param-desc">
    Resultado de la consulta.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.success Indica si la operación fue exitosa.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.graph] Objeto con los datos para la gráfica.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.graph.timestamps Array de etiquetas de tiempo (hh:mm).
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;string></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.graph.index Array del índice normalizado (0–1+) por instante.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;number></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.graph.o3 Array de valores de O3.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;number></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.graph.no2 Array de valores de NO2.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;number></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    result.graph.co Array de valores de CO.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;number></span>


    </dd>
</dl>
</li>
    
        <li>
<div class="param-desc">
    [result.message] Mensaje de error si la operación falla o no hay nodo vinculado.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>
</li>
    </ul>





        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id="Nodo">Nodo</h4>




<div class="description">
    Servicio para la gestión y consulta de nodos.

Obtiene los nodos registrados en el sistema y permite filtrar por tipo:
- `"todos"`: devuelve todos los nodos.
- `"inactivos"`: nodos que no han actualizado su estado en más de un mes.
- `"erroneos"`: nodos con mediciones fuera de los rangos esperados o con poca variabilidad.
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">ID del nodo.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Nombre del nodo.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>username</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type">null</span>


            
            </td>

            

            

            <td class="description last">Nombre de usuario vinculado, si lo hay.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>status</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Estado actual del nodo ('active' o 'inactive').</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>lastStatusUpdate</code></td>
            

            <td class="type">
            
                
<span class="param-type">Date</span>


            
            </td>

            

            

            <td class="description last">Última actualización de estado.</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    
    <dt class="tag-author">Author:</dt>
    <dd class="tag-author">
        <ul>
            <li>Maria Algora</li>
        </ul>
    </dd>
    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="logica.js.html">logica.js</a>, <a href="logica.js.html#line1387">line 1387</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-middlewares.html">middlewares</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addDailyStats">addDailyStats</a></li><li><a href="global.html#addPoints">addPoints</a></li><li><a href="global.html#apply">apply</a></li><li><a href="global.html#calculateDistance">calculateDistance</a></li><li><a href="global.html#calidad_del_aire_cara_y_mensaje">calidad_del_aire_cara_y_mensaje</a></li><li><a href="global.html#clasificarCalidadDelAire">clasificarCalidadDelAire</a></li><li><a href="global.html#deleteApplication">deleteApplication</a></li><li><a href="global.html#enviarCorreoRecuperacion">enviarCorreoRecuperacion</a></li><li><a href="global.html#generateCouponCode">generateCouponCode</a></li><li><a href="global.html#getAirQualitySummary">getAirQualitySummary</a></li><li><a href="global.html#getAyuntamientos">getAyuntamientos</a></li><li><a href="global.html#getLinkedNodeOfUser">getLinkedNodeOfUser</a></li><li><a href="global.html#getMeasurements">getMeasurements</a></li><li><a href="global.html#getNearestMeasurement">getNearestMeasurement</a></li><li><a href="global.html#getPoints">getPoints</a></li><li><a href="global.html#getPrizes">getPrizes</a></li><li><a href="global.html#getRedemptionHistory">getRedemptionHistory</a></li><li><a href="global.html#get_distancia">get_distancia</a></li><li><a href="global.html#get_puntos">get_puntos</a></li><li><a href="global.html#get_tiempo">get_tiempo</a></li><li><a href="global.html#insertMeasurement">insertMeasurement</a></li><li><a href="global.html#linkNodeToUser">linkNodeToUser</a></li><li><a href="global.html#loginUser">loginUser</a></li><li><a href="global.html#recoverPassword">recoverPassword</a></li><li><a href="global.html#redeemPrize">redeemPrize</a></li><li><a href="global.html#registerUser">registerUser</a></li><li><a href="global.html#sendMail">sendMail</a></li><li><a href="global.html#unlinkNodeFromUser">unlinkNodeFromUser</a></li><li><a href="global.html#updateUser">updateUser</a></li><li><a href="global.html#updateUserActivity">updateUserActivity</a></li><li><a href="global.html#valores_grafica">valores_grafica</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Fri Dec 19 2025 14:43:19 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>